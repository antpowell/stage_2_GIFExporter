{"version":3,"sources":["src\\EncodedImage.ts","src\\GIFGenerator.ts"],"names":[],"mappings":"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","file":"GIFGenerator.6171d4fc.map","sourceRoot":"..","sourcesContent":["export class EncodedImage {\r\n\tdata: number[] = [];\r\n\r\n\tconstructor() {}\r\n\r\n\tget() {\r\n\t\treturn this.data as number[];\r\n\t}\r\n\r\n\twrite(byte: number) {\r\n\t\tthis.data.push(byte);\r\n\t}\r\n\r\n\twriteArray(array: number[], arraySize: number) {\r\n\t\tfor (let i = 0; i < arraySize; i++) {\r\n\t\t\tthis.write(array[i]);\r\n\t\t}\r\n\t}\r\n\r\n\twriteUTF(UTF: string) {\r\n\t\tfor (let i = 0; i < UTF.length; i++) {\r\n\t\t\tthis.write(UTF.charCodeAt(i));\r\n\t\t}\r\n\t}\r\n\r\n\twriteColor(color: string) {\r\n\t\tfor (let i = 0; i < color.length; i += 2) {\r\n\t\t\tconst intValue: number = parseInt(color[i] + color[i + 1], 16);\r\n\t\t\tthis.write(intValue);\r\n\t\t}\r\n\t}\r\n\r\n\twriteLittleEndian(num: number) {\r\n\t\tthis.write(num & 0xff);\r\n\t\tthis.write((num >> 8) & 0xff);\r\n\t}\r\n}\r\n","import { EncodedImage } from './EncodedImage';\r\n///<reference path = '../JS/LZWEncoder.js'/>\r\n\r\nexport class GIFGenerator {\r\n\tstream: EncodedImage = new EncodedImage();\r\n\tbyteCount: number = 0;\r\n\twidth: number;\r\n\theight: number;\r\n\tencodedImage: EncodedImage = new EncodedImage();\r\n\tframeIndexedPixels: number[];\r\n\tframeCount: number = 0;\r\n\tGCT: string[];\r\n\r\n\tconstructor(width: number, height: number, GCT: string[]) {\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t\tthis.GCT = GCT;\r\n\t\tconsole.log(`Generator now running...`);\r\n\t}\r\n\r\n\tinit() {\r\n\t\tthis.headerGenerator();\r\n\t\tthis.LSDGenerator();\r\n\t\tthis.GCTWriter();\r\n\t\tthis.AppExtGenerator();\r\n\t}\r\n\r\n\tgenerateFrame(indexedPixels: number[], frameCount?: number) {\r\n\t\tthis.frameIndexedPixels = indexedPixels;\r\n\t\tthis.frameCount += 1;\r\n\t\tconsole.log(`generating frame ${this.frameCount}`);\r\n\t\tthis.GCEGenerator();\r\n\t\tthis.imgDescGenerator();\r\n\t\tthis.imgDataGenerator();\r\n\t}\r\n\r\n\tdownload(filename: string) {\r\n\t\tthis.TrailerGenerator();\r\n\r\n\t\tconsole.log('downloading');\r\n\t\tconsole.log(this.stream);\r\n\r\n\t\tconst download = document.createElement('a');\r\n\t\tdownload.download = filename;\r\n\t\tdownload.href = URL.createObjectURL(\r\n\t\t\tnew Blob([new Uint8Array(this.stream.get())], {\r\n\t\t\t\ttype: 'image/gif'\r\n\t\t\t})\r\n\t\t);\r\n\t\tdownload.click();\r\n\t}\r\n\r\n\theaderGenerator() {\r\n\t\tthis.stream.writeUTF('GIF89a'); /* GIF Header */\r\n\t}\r\n\r\n\tLSDGenerator() {\r\n\t\tthis.stream.writeLittleEndian(this.width); /* Canvas Width */\r\n\t\tthis.stream.writeLittleEndian(this.height); /* Canvas Height */\r\n\t\tthis.stream.write(0xf7); /* Packed Field */\r\n\t\tthis.stream.write(0); /* Background Color Index */\r\n\t\tthis.stream.write(0); /* Pixel Aspect Ration */\r\n\t}\r\n\r\n\tGCEGenerator() {\r\n\t\tthis.stream.write(0x21); /* Extension Introducer */\r\n\t\tthis.stream.write(0xf9); /* Graphic Control Label */\r\n\t\tthis.stream.write(0x4); /* Byte Size */\r\n\t\tthis.stream.write(0x4); /* Packed Field */\r\n\t\tthis.stream.writeLittleEndian(0x32); /* Delay Time */\r\n\t\tthis.stream.write(0x0); /* Transparent Color Index */\r\n\t\tthis.stream.write(0x0); /* Block Terminator */\r\n\t}\r\n\r\n\timgDescGenerator() {\r\n\t\tthis.stream.write(0x2c); /* Image Seperator Always 2C */\r\n\t\tthis.stream.writeLittleEndian(0x0); /* Image Left */\r\n\t\tthis.stream.writeLittleEndian(0x0); /* Image Top */\r\n\t\tthis.stream.writeLittleEndian(this.width); /* Image Width */\r\n\t\tthis.stream.writeLittleEndian(this.height); /* Image Height */\r\n\t\tthis.stream.write(0x0); /* Block Terminator */\r\n\t}\r\n\r\n\tAppExtGenerator() {\r\n\t\tthis.stream.write(0x21); /* extension introducer */\r\n\t\tthis.stream.write(0xff); /* app extension label */\r\n\t\tthis.stream.write(11); /* block size */\r\n\t\tthis.stream.writeUTF('NETSCAPE' + '2.0'); /* app id + auth code */\r\n\t\tthis.stream.write(3); /* sub-block size */\r\n\t\tthis.stream.write(1); /* loop sub-block id */\r\n\t\tthis.stream.writeLittleEndian(\r\n\t\t\t0\r\n\t\t); /* loop count (extra iterations, 0=repeat forever) */\r\n\t\tthis.stream.write(0); /* Block Terminator */\r\n\t}\r\n\r\n\tTrailerGenerator() {\r\n\t\tthis.stream.write(0x3b); /* Trailer Marker */\r\n\t\tconsole.log(`Generator now finished.`);\r\n\t}\r\n\r\n\tGCTWriter() {\r\n\t\tlet count = 0;\r\n\r\n\t\tthis.GCT.forEach(color => {\r\n\t\t\tcount += 3;\r\n\t\t\tthis.stream.writeColor(color);\r\n\t\t});\r\n\r\n\t\tfor (let i = count; i < 3 * 256; i++) {\r\n\t\t\tthis.stream.write(0);\r\n\t\t}\r\n\t}\r\n\r\n\timgDataGenerator() {\r\n\t\tconst encoder = new LZWEncoder(\r\n\t\t\tthis.width,\r\n\t\t\tthis.height,\r\n\t\t\tthis.frameIndexedPixels,\r\n\t\t\t8\r\n\t\t);\r\n\t\tencoder.encode(this.stream);\r\n\t\tconsole.log(`completed frame ${this.frameCount}`);\r\n\t}\r\n\r\n\tLCTGenerator() {}\r\n\r\n\tPlainTextExtGenerator() {}\r\n\r\n\tCommentExtGenerator() {}\r\n\r\n\twriteLittleEndian(num: number) {\r\n\t\tthis.stream.write(num & 0xff);\r\n\t\tthis.stream.write((num >> 8) & 0xff);\r\n\t}\r\n}\r\n"]}