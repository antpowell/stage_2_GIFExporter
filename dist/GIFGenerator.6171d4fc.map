{"version":3,"sources":["src\\EncodedImage.ts","src\\GIFGenerator.ts"],"names":[],"mappings":"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","file":"GIFGenerator.6171d4fc.map","sourceRoot":"..","sourcesContent":["export class EncodedImage {\r\n\tdata: number[] = [];\r\n\r\n\tconstructor() {}\r\n\r\n\tget() {\r\n\t\treturn this.data as number[];\r\n\t}\r\n\r\n\twrite(byte: number) {\r\n\t\tthis.data.push(byte);\r\n\t}\r\n\r\n\twriteArray(array: number[], arraySize: number) {\r\n\t\tfor (let i = 0; i < arraySize; i++) {\r\n\t\t\tthis.write(array[i]);\r\n\t\t}\r\n\t}\r\n\r\n\twriteUTF(UTF: string) {\r\n\t\tfor (let i = 0; i < UTF.length; i++) {\r\n\t\t\tthis.write(UTF.charCodeAt(i));\r\n\t\t}\r\n\t}\r\n\r\n\twriteColor(color: string) {\r\n\t\tfor (let i = 0; i < color.length; i += 2) {\r\n\t\t\tconst intValue: number = parseInt(color[i] + color[i + 1], 16);\r\n\t\t\tthis.write(intValue);\r\n\t\t}\r\n\t}\r\n\r\n\twriteLittleEndian(num: number) {\r\n\t\tthis.write(num & 0xff);\r\n\t\tthis.write((num >> 8) & 0xff);\r\n\t}\r\n}\r\n","import { EncodedImage } from './EncodedImage';\r\n///<reference path = 'JS/LZWEncoder.js'/>\r\n\r\nexport class GIFGenerator {\r\n\tstream: EncodedImage = new EncodedImage();\r\n\tbyteCount: number = 0;\r\n\twidth: number;\r\n\theight: number;\r\n\tencodedImage: EncodedImage = new EncodedImage();\r\n\tframeIndexedPixels: number[];\r\n\tframeCount: number = 0;\r\n\tGCT: string[];\r\n\r\n\tconstructor(width: number, height: number, GCT: string[]) {\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t\tthis.GCT = GCT;\r\n\t\tconsole.log(`Generator now running...`);\r\n\t}\r\n\r\n\tinit() {\r\n\t\tthis.headerGenerator();\r\n\t\tthis.LSDGenerator();\r\n\t\tthis.GCTWriter();\r\n\t\tthis.AppExtGenerator();\r\n\t}\r\n\r\n\tgenerateFrame(indexedPixels: number[], frameCount?: number) {\r\n\t\tthis.frameIndexedPixels = indexedPixels;\r\n\t\tthis.frameCount += 1;\r\n\t\tconsole.log(`generating frame ${this.frameCount}`);\r\n\t\tthis.GCEGenerator();\r\n\t\tthis.imgDescGenerator();\r\n\t\tthis.imgDataGenerator();\r\n\t}\r\n\r\n\tdownload(filename: string) {\r\n\t\tthis.TrailerGenerator();\r\n\r\n\t\tconsole.log('downloading');\r\n\t\tconsole.log(this.stream);\r\n\r\n\t\tconst download = document.createElement('a');\r\n\t\tdownload.download = filename;\r\n\t\tdownload.href = URL.createObjectURL(\r\n\t\t\tnew Blob([new Uint8Array(this.stream.get())], {\r\n\t\t\t\ttype: 'image/gif'\r\n\t\t\t})\r\n\t\t);\r\n\t\tdownload.click();\r\n\t}\r\n\r\n\theaderGenerator() {\r\n\t\tthis.stream.writeUTF('GIF89a'); /* GIF Header */\r\n\t}\r\n\r\n\tLSDGenerator() {\r\n\t\tthis.stream.writeLittleEndian(this.width); /* Canvas Width */\r\n\t\tthis.stream.writeLittleEndian(this.height); /* Canvas Height */\r\n\t\tthis.stream.write(0xf7); /* Packed Field */\r\n\t\tthis.stream.write(0); /* Background Color Index */\r\n\t\tthis.stream.write(0); /* Pixel Aspect Ration */\r\n\t}\r\n\r\n\tGCEGenerator() {\r\n\t\tthis.stream.write(0x21); /* Extension Introducer */\r\n\t\tthis.stream.write(0xf9); /* Graphic Control Label */\r\n\t\tthis.stream.write(0x4); /* Byte Size */\r\n\t\tthis.stream.write(0x4); /* Packed Field */\r\n\t\tthis.stream.writeLittleEndian(0x32); /* Delay Time */\r\n\t\tthis.stream.write(0x0); /* Transparent Color Index */\r\n\t\tthis.stream.write(0x0); /* Block Terminator */\r\n\t}\r\n\r\n\timgDescGenerator() {\r\n\t\tthis.stream.write(0x2c); /* Image Seperator Always 2C */\r\n\t\tthis.stream.writeLittleEndian(0x0); /* Image Left */\r\n\t\tthis.stream.writeLittleEndian(0x0); /* Image Top */\r\n\t\tthis.stream.writeLittleEndian(this.width); /* Image Width */\r\n\t\tthis.stream.writeLittleEndian(this.height); /* Image Height */\r\n\t\tthis.stream.write(0x0); /* Block Terminator */\r\n\t}\r\n\r\n\tAppExtGenerator() {\r\n\t\tthis.stream.write(0x21); /* extension introducer */\r\n\t\tthis.stream.write(0xff); /* app extension label */\r\n\t\tthis.stream.write(11); /* block size */\r\n\t\tthis.stream.writeUTF('NETSCAPE' + '2.0'); /* app id + auth code */\r\n\t\tthis.stream.write(3); /* sub-block size */\r\n\t\tthis.stream.write(1); /* loop sub-block id */\r\n\t\tthis.stream.writeLittleEndian(\r\n\t\t\t0\r\n\t\t); /* loop count (extra iterations, 0=repeat forever) */\r\n\t\tthis.stream.write(0); /* Block Terminator */\r\n\t}\r\n\r\n\tTrailerGenerator() {\r\n\t\tthis.stream.write(0x3b); /* Trailer Marker */\r\n\t\tconsole.log(`Generator now finished.`);\r\n\t}\r\n\r\n\tGCTWriter() {\r\n\t\tlet count = 0;\r\n\r\n\t\tthis.GCT.forEach(color => {\r\n\t\t\tcount += 3;\r\n\t\t\tthis.stream.writeColor(color);\r\n\t\t});\r\n\r\n\t\tfor (let i = count; i < 3 * 256; i++) {\r\n\t\t\tthis.stream.write(0);\r\n\t\t}\r\n\t}\r\n\r\n\timgDataGenerator() {\r\n\t\tconst encoder = new LZWEncoder(\r\n\t\t\tthis.width,\r\n\t\t\tthis.height,\r\n\t\t\tthis.frameIndexedPixels,\r\n\t\t\t8\r\n\t\t);\r\n\t\tencoder.encode(this.stream);\r\n\t\tconsole.log(`completed frame ${this.frameCount}`);\r\n\t}\r\n\r\n\tLCTGenerator() {}\r\n\r\n\tPlainTextExtGenerator() {}\r\n\r\n\tCommentExtGenerator() {}\r\n\r\n\twriteLittleEndian(num: number) {\r\n\t\tthis.stream.write(num & 0xff);\r\n\t\tthis.stream.write((num >> 8) & 0xff);\r\n\t}\r\n}\r\n"]}