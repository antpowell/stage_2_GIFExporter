{"version":3,"sources":["src\\EncodedImage.ts","src\\WebWoker.ts","src\\GIFGenerator.ts"],"names":[],"mappings":"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","file":"GIFGenerator.6171d4fc.map","sourceRoot":"..","sourcesContent":["export class EncodedImage {\r\n\tdata: number[] = [];\r\n\r\n\tconstructor() {}\r\n\r\n\tpublic get(): number[] {\r\n\t\treturn this.data;\r\n\t}\r\n\r\n\tpublic write(byte: number): void {\r\n\t\tthis.data.push(byte);\r\n\t}\r\n\r\n\tpublic writeArray(array: number[], arraySize: number): void {\r\n\t\tfor (let i = 0; i < arraySize; i++) {\r\n\t\t\tthis.write(array[i]);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic writeUTF(UTF: string): void {\r\n\t\tfor (let i = 0; i < UTF.length; i++) {\r\n\t\t\tthis.write(UTF.charCodeAt(i));\r\n\t\t}\r\n\t}\r\n\r\n\tpublic writeColor(color: string): void {\r\n\t\tfor (let i = 0; i < color.length; i += 2) {\r\n\t\t\tconst intValue: number = parseInt(color[i] + color[i + 1], 16);\r\n\t\t\tthis.write(intValue);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic writeLittleEndian(num: number): void {\r\n\t\tthis.write(num & 0xff);\r\n\t\tthis.write((num >> 8) & 0xff);\r\n\t}\r\n}\r\n","export class WebWork {\r\n\tconstructor() {}\r\n\r\n\tpublic LZWEncoding() {\r\n\t\tconst now = performance.now();\r\n\t\tconsole.log(`LZW time taken: ${performance.now() - now}`);\r\n\t}\r\n}\r\n","import { EncodedImage } from './EncodedImage';\r\nimport { WebWork } from './WebWoker';\r\n///<reference path = '../JS/LZWEncoder.js'/>\r\n\r\nexport class GIFGenerator {\r\n\tprivate stream: EncodedImage = new EncodedImage();\r\n\tprivate width: number;\r\n\tprivate height: number;\r\n\tprivate frameIndexedPixels: number[];\r\n\tprivate frameCount: number = 0;\r\n\tprivate GCT: string[];\r\n\tprivate _webWorker: WebWork;\r\n\r\n\tconstructor(width: number, height: number, GCT: string[]) {\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t\tthis.GCT = GCT;\r\n\t\tconsole.log(`Generator now running...`);\r\n\t}\r\n\r\n\tpublic init(): void {\r\n\t\tthis._webWorker = new WebWork();\r\n\t\tthis.headerGenerator();\r\n\t\tthis.LSDGenerator();\r\n\t\tthis.GCTWriter();\r\n\t\tthis.AppExtGenerator();\r\n\t}\r\n\r\n\tpublic generateFrame(indexedPixels: number[]): void {\r\n\t\tthis.frameIndexedPixels = indexedPixels;\r\n\t\tthis.frameCount += 1;\r\n\t\tconsole.log(`generating frame ${this.frameCount}`);\r\n\t\tthis.GCEGenerator();\r\n\t\tthis.imgDescGenerator();\r\n\t\tthis.imgDataGenerator();\r\n\t}\r\n\r\n\tpublic getStream(): number[] {\r\n\t\tthis.TrailerGenerator();\r\n\t\treturn this.stream.get();\r\n\t}\r\n\r\n\tprivate headerGenerator(): void {\r\n\t\tthis.stream.writeUTF('GIF89a'); /* GIF Header */\r\n\t}\r\n\r\n\tprivate LSDGenerator(): void {\r\n\t\tthis.stream.writeLittleEndian(this.width); /* Canvas Width */\r\n\t\tthis.stream.writeLittleEndian(this.height); /* Canvas Height */\r\n\t\tthis.stream.write(0xf7); /* Packed Field */\r\n\t\tthis.stream.write(0); /* Background Color Index */\r\n\t\tthis.stream.write(0); /* Pixel Aspect Ration */\r\n\t}\r\n\r\n\tprivate GCEGenerator(): void {\r\n\t\tthis.stream.write(0x21); /* Extension Introducer */\r\n\t\tthis.stream.write(0xf9); /* Graphic Control Label */\r\n\t\tthis.stream.write(0x4); /* Byte Size */\r\n\t\tthis.stream.write(0x4); /* Packed Field */\r\n\t\tthis.stream.writeLittleEndian(0x9); /* Delay Time */\r\n\t\tthis.stream.write(0x0); /* Transparent Color Index */\r\n\t\tthis.stream.write(0x0); /* Block Terminator */\r\n\t}\r\n\r\n\tprivate imgDescGenerator(): void {\r\n\t\tthis.stream.write(0x2c); /* Image Seperator Always 2C */\r\n\t\tthis.stream.writeLittleEndian(0x0); /* Image Left */\r\n\t\tthis.stream.writeLittleEndian(0x0); /* Image Top */\r\n\t\tthis.stream.writeLittleEndian(this.width); /* Image Width */\r\n\t\tthis.stream.writeLittleEndian(this.height); /* Image Height */\r\n\t\tthis.stream.write(0x0); /* Block Terminator */\r\n\t}\r\n\r\n\tprivate AppExtGenerator(): void {\r\n\t\tthis.stream.write(0x21); /* extension introducer */\r\n\t\tthis.stream.write(0xff); /* app extension label */\r\n\t\tthis.stream.write(11); /* block size */\r\n\t\tthis.stream.writeUTF('NETSCAPE' + '2.0'); /* app id + auth code */\r\n\t\tthis.stream.write(3); /* sub-block size */\r\n\t\tthis.stream.write(1); /* loop sub-block id */\r\n\t\tthis.stream.writeLittleEndian(\r\n\t\t\t0\r\n\t\t); /* loop count (extra iterations, 0=repeat forever) */\r\n\t\tthis.stream.write(0); /* Block Terminator */\r\n\t}\r\n\r\n\tprivate TrailerGenerator(): void {\r\n\t\tthis.stream.write(0x3b); /* Trailer Marker */\r\n\t\tconsole.log(`Generator now finished.`);\r\n\t\tthis.frameCount = 0; /* Reset frame count for next GIF */\r\n\t}\r\n\r\n\tprivate GCTWriter(): void {\r\n\t\tlet count = 0;\r\n\r\n\t\tthis.GCT.forEach(color => {\r\n\t\t\tcount += 3;\r\n\t\t\tthis.stream.writeColor(color);\r\n\t\t});\r\n\r\n\t\tfor (let i = count; i < 3 * 256; i++) {\r\n\t\t\tthis.stream.write(0);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate imgDataGenerator(): void {\r\n\t\t// this._webWorker.LZWEncoder(this.width,\r\n\t\t// \tthis.height,\r\n\t\t// \tthis.frameIndexedPixels,\r\n\t\t// \t8);\r\n\t\tconst encoder = new LZWEncoder(\r\n\t\t\tthis.width,\r\n\t\t\tthis.height,\r\n\t\t\tthis.frameIndexedPixels,\r\n\t\t\t8\r\n\t\t);\r\n\t\tencoder.encode(this.stream);\r\n\t\tconsole.log(`completed frame ${this.frameCount}`);\r\n\t}\r\n\r\n\tprivate LCTGenerator(): void {}\r\n\r\n\tprivate PlainTextExtGenerator(): void {}\r\n\r\n\tprivate CommentExtGenerator(): void {}\r\n\r\n\tprivate writeLittleEndian(num: number): void {\r\n\t\tthis.stream.write(num & 0xff);\r\n\t\tthis.stream.write((num >> 8) & 0xff);\r\n\t}\r\n}\r\n"]}